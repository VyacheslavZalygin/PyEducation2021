import sys

# n - длина готового, k - длина очереди
# test = '207 103 47912 27183 52775 39770 28172 34411 64030 11573 35269 39493 20207 62796 40615 26520 23267 48794 18004 54415 59485 45548 8657 39719 20766 7312 9175 23432 42123 53259 7605 54388 32059 11037 6061 13742 45158 25756 4172 54294 8608 4970 45673 20747 10129 49086 51429 21019 59534 43942 55726 30271 48077 2217 10706 42342 22498 9531 26786 30105 20976 22573 15223 48598 37616 25245 20233 31532 35264 40596 26522 35565 3680 29557 13983 5023 19524 50315 29614 44522 63988 16554 60209 38881 54212 48602 55669 47819 40985 30979 54374 39920 1379 44337 63105 14086 17451 56389 6039 51938 53257 30799 34718 32711 54006 30838 64324 29616 61311 9525 8410 19756 37532 47864 47581 14068 31649 54261 50486 1791 37206 42459 57785 23733 58992 12983 53341 23126 6326 5718 59627 19341 18018 27610 17965 46684 55546 3693 40210 34658 48447 30102 24784 58752 9123 36479 57747 55566 54119 57764 17494 26594 29690 13738 33902 28704 17697 21948 13575 3577 23678 62917 33428 48121 700 12085 57689 23430 9751 4264 16977 29932 10435 59223 1683 1957 49359 19322 2255 56441 61139 65424 45945 22293 46895 13844 5593 43618 13890 52359 40068 40366 63577 63532 43452 46530 25853 46525 20270 8655 8679 38977 39382 49332 12266 39702 4914 7687 1419'
# test = '5 4 1 1 1 1 1'
N, K, *data = [int(x) for x in sys.stdin.read().split()]
d = 3
SOMETHING = 2**20

rems = [None] * d
m = None
k = K
while k < 100000-1:
    a_n = data[k]
    a_m = data[k-K]
    
    key = a_m % d
    if rems[key] == None or rems[key] < a_m:
        rems[key] = a_m
    
    alt_key = (d - (a_n % d)) % d
    if rems[alt_key] != None:
        if m == None or m < rems[alt_key] + a_n:
            m = rems[alt_key] + a_n
    
    # считаем следующий элемент
    k += 1
    if k+1 > N:
        if m == None:
            data.append(k+1)
        else:
            data.append(
                ((m**2 // 3) + (k+1)) % SOMETHING
            )

print(data[-1])